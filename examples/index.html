<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>ARnft example with a gltf model</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=1">
	<link rel="stylesheet" href="./css/nft-style.css">
</head>
<body>
<script src="../dist/jquery-1.6.2.js"></script>
<script src="../dist/html2canvas.js"></script>
<script src="../dist/canvas2image.js"></script>
<canvas id="photoCanvas"></canvas>
<script>

var userDeviceArray = [
    {device: 'Android', platform: /Android/},
    {device: 'iPhone', platform: /iPhone/},
    {device: 'iPad', platform: /iPad/},
    {device: 'Symbian', platform: /Symbian/},
    {device: 'Windows Phone', platform: /Windows Phone/},
    {device: 'Tablet OS', platform: /Tablet OS/},
    {device: 'Linux', platform: /Linux/},
    {device: 'Windows', platform: /Windows NT/},
    {device: 'Macintosh', platform: /Macintosh/}
];

var platform = navigator.userAgent;

function getPlatform() {
    for (var i in userDeviceArray) {
        if (userDeviceArray[i].platform.test(platform)) {
            return userDeviceArray[i].device;
        }
    }
    return platform;
}


	var scrvid;
	var app;
	var rendCanvas;
	var photoCanvas;
	var retCtx;
	var video;
	
	function genScreenshot() {
		app = document.getElementById('app');
		photoCanvas = document.getElementById("photoCanvas");
		rendCanvas = document.getElementById("canvas");
		video = document.getElementById('video');
		
		photoCanvas.width = rendCanvas.width;
		photoCanvas.height = rendCanvas.height;
		
		retCtx = photoCanvas.getContext('2d');
		
		if (getPlatform() == "iPhone" || getPlatform() == "iPad")
		{
			retCtx.drawImage(video, 0, 0, photoCanvas.width, photoCanvas.height);
			ScreenModel();
		}
		else
		{
			retCtx.drawImage(video, 0, 0, photoCanvas.width, photoCanvas.height);
			retCtx.drawImage(rendCanvas, 0, 0, photoCanvas.width, photoCanvas.height);
		}
		
			//retCtx.drawImage(video, 0, 0, photoCanvas.width, photoCanvas.height);
			//retCtx.drawImage(rendCanvas, 0, 0, photoCanvas.width, photoCanvas.height);
		
			//ScreenModel();
			//ScreenVideo();
        
		Canvas2Image.saveAsPNG(photoCanvas);
	}
	
	/*
	function genScreenshot() {
		html2canvas(document.getElementById('app'), {
			onrendered: function(canvas) {
				return Canvas2Image.saveAsPNG(canvas);
			}
		});
	}
*/

	function ScreenModel() {
		html2canvas(document.getElementById('app'), {
			onrendered: function(canvas) {
				retCtx.drawImage(canvas, 0, 0, photoCanvas.width, photoCanvas.height);
			}
		});
	}

	
	function ScreenVideo(){
		
		scrvid = document.createElement('canvas');
		scrvid.setAttribute( "id", "scrvid" );
				
		//app.append(scrvid);
		
		//retCtx = scrvid.getContext('2d');
		
		scrvid.width = rendCanvas.width;
		scrvid.height = rendCanvas.height;
	
		retCtx.drawImage(video, 0, 0, scrvid.width, scrvid.height, 0, 0, scrvid.width, scrvid.height);
		
		html2canvas(scrvid, {
			onrendered: function(canvas) {
				retCtx.drawImage(canvas, 0, 0, photoCanvas.width, photoCanvas.height);
			}
		});
	}
	
	function screen(){
		html2canvas(document.getElementById('app'), {
			onrendered: function(canvas) {
				return Canvas2Image.saveAsPNG(canvas);
			}
		});
	}
	</script>

    <button onclick="genScreenshot()" style="outline: none; border: none; padding-top: none; padding-bottom: none; padding-left: none; padding-right: none;">
  <img src="t2.png" style="
  position: absolute;
  z-index: 99999999;
  width: 5pc;
  height: 4pc;
  left: 50%;
  top: 100%;
  margin-left: -2.5pc;
  margin-top: -7.5pc;">
  </button>


      <a
          href="Data/wall.png"
          class="ui marker"
          target="_blank">
          ðŸ–¼ Marker Image ver 0.548 screnim vse + if platform
      </a>

		<script src="./js/third_party/three.js/three.min.js"></script>
		<script src="../dist/ARnft.js"></script>

    <script>
			ARnft.ARnft.init(640, 480, "examples/DataNFT/wall/wall_a1_10_300", 'config.json', true)
			.then((nft) => {
				nft.addModel('./Data/models/Duck/glTF/Duck.glb', 40, 80, 80, 80);
			}).catch((error) => {
				console.log(error);
			});
    </script>
	<div  id="box1" style="visible:hidden;"></div>
</body>

</html>
